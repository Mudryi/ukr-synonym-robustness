import pymorphy2
import json 
from tqdm import tqdm

deletions = {
    "чоловік": ["жінка", "подружжя", "дружина", "подруга"],
    "жінка": ["чоловік"],
    "місце": ["ід"],
    "стояти": ["клячати", "писатися"],
    "грати": ["зображати"],
    "люди": ["мир"],
    "смугастий": ["із смугами"],
    "сонце": ["приязнь"],
    "вода": ["курорт"],
    "хлопець": ["дівчина"],
    "дівчина": ["коханий"],
    "маленький": ["великий"],
    "білий": ["чорний"],
    "рука": ["у десна"],
    "стіл": ["харч"],
    "рожевий": ["радісний"],
    "чорний": ["білий"],
    "виконувати": ["терликати"],
    "сидіти": ["проживати", "(на", "мешкати"],
    "молодий": ["старий"],
    "шикарний": ["тонкий"],
    "собака": ["змія"],
    "яскравий": ["погідний"],
    "потужний": ["грубий"],
    "купити": ["ошукати", "обманути", "обманювати", "перекупити"],
    "купувати": ["перекупити", "прихиляти", "приваблювати", "обманювати", "обманути"],
    "добрий": ["жалісний"],
    "проблема": ["інтерес", 'діло', 'справа'],
    "хороший": ["обметаний", "дивний", "обстріляний", "тертий", "порядний", "препишний", "провчений", "прегарний", "спокушений",
                "близький"],
    "гарний": ["дивний", "препишний"],
    "чудовий": ["дивний", "препишний"],
    "пропускати": ["поминути"],
    "нарікання": ['літаня', 'літанія'],
    "займати": ["романсувати"],
    "крутий": ["поганий", "непристойний"],
    'великий': ["страшний", "неправдоподібний", "страшенний", 'надлюдський', 'непередаваний', 'найбільший', 'знаний',
            'несосвітенний','неописаний', 'могутній', 'скрутний', 'дорослі', 'втяжливий', 'цінний', 'прикрий', 'дорогий', 
            'рославий', 'дорослий', 'шпаркий', 'добрий', 'святий', 'казковий', 'широкий', 'славний', 'історичний', 'оперений',
            'гострий', 'страхітний', 'глибокий', 'надсильний', 'страшезний', 'незвичайний', 'дужий', 'несказанний', 'тяжкий',
            'небувалий', 'неземний', 'широчезний', 'виїмковий', 'невичерпний', 'сугубий','дошкульний', 'кріпкий',
            'незрівнянний', 'несходжений', 'бурхливий', 'безумний', 'чільний', 'опірений', 'безкрайній', 'екстраординарний',
            'ярий', 'вирішальний','безбережний', 'трудний', 'вальний', 'численний', 'неописанний', 'неймовірний',
            'невимірний', 'нелегкий', 'щедрий', 'сутужний', 'рослий', 'незглибимий', 'важний', 'сильний', 'незлічимий', 
            'священний', 'поважний', 'відомий', 'цупкий', 'непосильний', 'нестямний', 'неоглядний', 'неосяжний', 'визначний',
            'повнолітній', 'побільшений', 'несходимий', 'пекельний', 'винятковий', 'унікальний', 'жорстокий', 'дорогоцінний',
            'несвітський', 'широкополий',  'клятий', 'просторий', 'смертельний', 'незміряний', 'безкраїй',
            'бездонний', 'блискучий', 'ваговитий', "об'ємний", 'невимовний', 'значущий', 'знаменний', 'дивовижний',
            'вагомий', 'широченний', 'дозрілий', 'страхітливий', 'безтямний', 'громіздкий', 'складний', 'особливий',
            'рідкий', 'необмежений', 'фантастичний', 'рясний', 'важливий', 'лютий', 'багатий', 'надзвичайний', 'високий',
            'знаменитий', 'міцний', 'шалений', 'неоцінний', 'значливий', 'ядерний', 'старші', 'несамовитий',
            'неоціненний', 'важкий', 'пекучий', 'двожильний', 'утяжливий', 'гомеричний', 'благородний', 'немаловажний',
            'почесний', 'безмірний', 'надприродний','славетний', 'нелюдський', "об'ємистий", 'безкінечний', 'надмірний',
            'незчисленний', 'титанічний', 'добірний', 'рідкісний', 'щедротний', 'безконечний', 'чорний', 'тисячний'],
    "працювати": ["гирувати", "потіти", "пріти", "пробувати", "посідати", "ввихатися"],
    "пріти": ["працювати"],
    "день": ["існування", "дні"],
    "замовлення": ["замова"],
    "відмінний": ["непохожий"],
    "рівний": ["однотонний"],
    "звичайний": ["непривабний"],
    "мати": ["мая", "владичиця", "мусить", "посідати", "вважати", "маяти", "приймати"],
    "захват": ["пафос", "самозабуття", "опал"],
    "ідеальний": ["загальний", "абстрактний"],
    "запах": ["настій"],
    "надійний": ["благонамірений"],
    "тримати": ["підпирати"],
    "нижчий": ["елементарний"],
    "сушить": ["підтяти"],
    "позитивний": ["хвальний"],
    "якість": ["доброякісність", "признак"],
    "легкий": ["слабкий", "слабий"],
    "отримати": ["підробляти"],
    "повертатися": ["підтримувати"],
    "слабкий": ["учнівський"],
    "сріблястий": ["тремкий"],
    "тихо": ["нешвидко"],
    "триматися": ["обернутися"],
    "зручно": ["корисно"],
    "брати": ["загарбати", "розстаратися", "видрати", "ошибати", "повінчатися"],
    "якісний": ["високий"],
    "попередній": ["приблизний"],
    "міцний": ["страшенний"],
    "зона": ['сажка'],
    "плівка": ["прожилка"],
    "легко": ["недовго", "дешево", "голіруч"],
    "гарно": ["благо"],
    "набагато": ["жахливо"],
    "відсутній": ["бездумний"],
    "верхній": ["верховинний"],
    "товар": ["маржина", "маржин", "бидло", "маржинка", "скотина", "худобина", "животина", "скот", "худоба"],
    "нема": ["катмає"],
    "зробити": ["сфабрикувати"],
    "грязь": ["місиво"],
    "прийти": ["їздити", "перейти"],
    "потужність": ["безодній", "безмежжя", 'безмір', 'безкрай', 'безодня', 'глибина'],
    "підійти": ["прибитися", "притиратися", "порушити", "прибитися", "зачинати", "підносити", "підбитися", "приступитися",
                    "просякти", "підроблюватися", "насунутися", "підроблятися", "підійняти", "насочуватися",
                    "піднімати", "підтягтися", "готуватися", "зближуватися", "прийматися", "розпочинати",
                    "підіймати", "зачати", "наближуватися", "приступити", "доступитися", "знестися", 'доходити',
                    "пристати", "доступати", "приживатися", "присунутися", "упиватися", "збиватися",
                    "назрівати", "ладнатися", "звестися", "прибути", "підбиратися", "присунути", "відноситися",
                    "насовувати", "підібратися", "підтягуватися", "підбиватися", "приміритися", "заходитися",
                    "заходжуватися", "порушати", "поближчати", "забиратися", "підтягатися", "розв'язувати",
                    "пнутися", "присмоктатися", "започинати", "підладжуватися", "зводитися", "присуватися",
                    "примощуватися", "примірятися", "доступатися", "лізти", "налагодити", "примінятися",
                    "прищеплюватися", "підійнятися", "просякнути", "приладновуватися", "зійти", "набігати",
                    "узятися", "прилучитися", "просочуватися", "примірюватися", "підводитися", "прилучатися",
                    "вжитися", "насуватися", "наладжувати", "підтягнутися", "настати", "прийти", "насувати",
                    "прижитися", "набратися", "приладитися", "починати", "приходити", "прикладатися",
                    "підкрадатися", "прищепитися", "налагоджувати", "підступити", "розв'язати", "прикочувати",
                    "прибиватися", "повитися", "приставати", "насовуватися", "насититися", "присовуватися",
                    "здійнятися", "почати", "підробитися", "приладнатися", "поставитися", "приладжуватися",
                    "наблизитися", "найти", "находити", "підладитися", "приступатися", "набиратися",
                    "насунути", "підвестися", "наладити", "надійти", "збігатися", "призвичитися", "іти",
                    "відкрити", "знятися", "прикластися", "присмоктуватися", "назріти", "приймати",
                    "прикочуватися", "придатися", "п'ястися", "йти", "підноситися", "зноситися", "поводитися",
                    "пройнятися", "сунутися", "упитися", "розпочати", "примазуватися", "ужитися", "розчинати",
                    "припасовуватися", "започати", "ітися", "набігти", "насичуватися", "сунути", "зближатися",
                    "прикотити", "адаптуватися", "просякати", "примазатися", "підкрастися", "уживатися",
                    "піднести", "витися", "призвичаюватися", "притертися", "призвичаїтися", "забратися",
                    "вбирати", "здатися", "піднестися", "прийняти", "повиватися", "сходити", "примоститися",
                    "зблизитися", "просочитися", "підійматися", "здійматися", "підняти", "укладатися",
                    "повестися", "віднестися", "пройматися", "прилаштовуватися", "порушувати", "збігтися",
                    "піднятися", "впитися", "пристосуватися", "підніматися", "приладнуватися", "пристроюватися",
                    "насочитися", "прикотитися", "взятися", "примінитися", "прищеплятися", "притиратися",
                    "пригодитися", "впиватися", "збитися", "зніматися", "доступити", "ближчати"],
    "підходити": ["прибитися", "притиратися", "порушити", "прибитися", "зачинати", "підносити", "підбитися", "приступитися",
                    "просякти", "підроблюватися", "насунутися", "підроблятися", "підійняти", "насочуватися", "межуватися",
                    "піднімати", "підтягтися", "готуватися", "зближуватися", "прийматися", "розпочинати",
                    "підіймати", "зачати", "наближуватися", "приступити", "доступитися", "знестися",
                    "пристати", "доступати", "приживатися", "присунутися", "упиватися", "збиватися",
                    "назрівати", "ладнатися", "звестися", "прибути", "підбиратися", "присунути",
                    "насовувати", "підібратися", "підтягуватися", "підбиватися", "приміритися", "заходитися",
                    "заходжуватися", "порушати", "поближчати", "забиратися", "підтягатися", "розв'язувати",
                    "пнутися", "присмоктатися", "започинати", "підладжуватися", "зводитися", "присуватися",
                    "примощуватися", "примірятися", "доступатися", "лізти", "налагодити", "примінятися",
                    "прищеплюватися", "підійнятися", "просякнути", "приладновуватися", "зійти", "набігати",
                    "узятися", "прилучитися", "просочуватися", "примірюватися", "підводитися", "прилучатися",
                    "вжитися", "насуватися", "наладжувати", "підтягнутися", "настати", "прийти", "насувати",
                    "прижитися", "набратися", "приладитися", "починати", "приходити", "прикладатися",
                    "підкрадатися", "прищепитися", "налагоджувати", "підступити", "розв'язати", "прикочувати",
                    "прибиватися", "повитися", "приставати", "насовуватися", "насититися", "присовуватися",
                    "здійнятися", "почати", "підробитися", "приладнатися", "поставитися", "приладжуватися",
                    "наблизитися", "найти", "находити", "підладитися", "приступатися", "набиратися",
                    "насунути", "підвестися", "наладити", "надійти", "збігатися", "призвичитися", "іти",
                    "відкрити", "знятися", "прикластися", "присмоктуватися", "назріти", "приймати",
                    "прикочуватися", "придатися", "п'ястися", "йти", "підноситися", "зноситися", "поводитися",
                    "пройнятися", "сунутися", "упитися", "розпочати", "примазуватися", "ужитися", "розчинати",
                    "припасовуватися", "започати", "ітися", "набігти", "насичуватися", "сунути", "зближатися",
                    "прикотити", "адаптуватися", "просякати", "примазатися", "підкрастися", "уживатися",
                    "піднести", "витися", "призвичаюватися", "притертися", "призвичаїтися", "забратися",
                    "вбирати", "здатися", "піднестися", "прийняти", "повиватися", "сходити", "примоститися",
                    "зблизитися", "просочитися", "підійматися", "здійматися", "підняти", "укладатися",
                    "повестися", "віднестися", "пройматися", "прилаштовуватися", "порушувати", "збігтися",
                    "піднятися", "впитися", "пристосуватися", "підніматися", "приладнуватися", "пристроюватися",
                    "насочитися", "прикотитися", "взятися", "примінитися", "прищеплятися", "притиратися",
                    "пригодитися", "впиватися", "збитися", "зніматися", "доступити", "ближчати"],
    'любити': ['сохнути', 'вимагати', 'дихати', 'вмирати', 'жалувати', 'потребувати', 'улюбити',
               'улюбляти', 'божествити', 'нуждатися', 'влюбити', 'потрібувати', 'обожувати', 'покохати', 'залюбляти',
               'пропадати', 'требувати', 'долюблювати', 'умирати', 'влюбляти'],
    'готувати': ['наладувати','опрацювати', 'постановити', 'впорядити', 'зварити', 'заготовити', 'обладувати',
                 'зібрати', 'призапасти', 'прилагодити', 'зладити', 'мітити', 'нарихтувати', 'заготовлювати',
                 'кухарювати', 'приладити', 'призапасити', 'спорядити', 'заготувати', 'обмундировувати',
                 'зряджати', 'розробити', 'зорганізувати', 'наготовлювати', 'злагодити', 'наладжувати',
                 'вирихтувати', 'запасти', 'наготувати', 'прилагоджувати', 'планувати', 'зарядити', 'виладнати', 
                 'опоряджувати', 'налагоджувати', 'упоряджати', 'влаштувати', 'креслити', 'зладнати', 'наряджати',
                 'нарядити','знарядити', 'поставити', 'знаряджати', 'улаштовувати', 'підготовлювати', 'наладити',
                 'підготовити', 'наготовити', 'організувати', 'приготовити', 'опорядити', 'обмундирувати', 'опрацьовувати',
                 'налаштовувати', 'улаштувати', 'запасати', 'налаштувати', 'припасати', 'обладити', 'поряджати', 'екіпірувати',
                 'заряджувати', 'збиратися', 'зрядити', 'порядити', 'наладнати', 'обрядити', 'припасти', 'обладжувати', 
                 'упорядити', 'дбати', 'обряджати', 'обряжати'],
    'їсти': ['вдивлятися', 'утупитися', 'корити', 'упертися', 'вглядітися', 'утнути', 'уджиґнути', 'впнутися',
         'мучити', 'укоряти', 'впиратися', 'погризти', 'роздирати', 'побити', 'роздивлятися', 'попеняти',
         'нарікати','сушити', 'вгледітися', 'вджиґнути', 'устромляти', 'колоти', 'закидати', 'домовляти',
         'розтерзати', 'жалити', 'роздивитися', 'осуджувати', 'проймати', 'мулити', 'відчитувати', 'приглянутися',
         'вичитувати', 'втупитися', 'проколоти', 'розідрати', 'пробрати', 'устромитися', 'випоминати', 'додивитися',
         'спекти', 'роздерти', 'призиратися', 'докорити', 'укорити', 'урікати', 'вректи', 'прасувати',
         'упинатися', 'проштрикнути', 'карати', 'доглядітися', 'утуплювати', 'розгризати', 'встромляти',
         'промацати', 'пожурити', 'вимовити', 'докучати', 'доглядатися', 'палити', 'впинатися', 'відчитати',
         'прирости', 'пиляти', 'пронизувати', 'врікати', 'штрикати', 'проникнути', 'шпигнути', 'штриконути',
         'золити', 'удивлятися', 'докоряти', 'тяти', 'пробирати', 'вглядатися', 'стрікнути', 'розпинати', 'покріплятися',
         'витріщитися', 'боліти', 'пригледітися', 'назирити', 'укладати', 'вкладати', 'приглядатися', 'доказати', 
         'вдивитися', 'проколювати', 'удивитися', 'упитися', 'проникати', 'ізсушити', 'вичитати', 'зморювати',
         'встромити', 'краяти', 'устромити', 'змучити', 'вимовляти', 'вбрати', 'наточити', 'прошити', 'замордувати', 
         'уколоти', 'пронизати', 'приростати', 'доректи', "вп'ялити", 'припадати', 'виговорювати', 'марудити', 
         'розшарпати', 'розшарпувати', 'витріщатися', 'зорити', 'закушувати', 'просвічувати', 'закусити', 'розкраяти', 
         'назирати', 'катувати', 'попрікати', 'замордовувати', 'вжалити', 'втупити', 'утирати',  'хлистати', 'вколоти',
         'упиратися', 'закатувати', 'уректи', 'попрікнути', 'зрубати', 'встромлювати', 'ганити', 'доказувати',
         'тиранізувати', 'придивлятися', 'угледітися', 'розгризти', 'журити', 'доганяти', 'встромлюватися',
         'углядітися', 'прошивати', 'підмести', 'устромлювати', 'цвіркнути', 'обгризати', 'трощити',
         'впертися', 'припасти', 'покарати', 'додивлятися', 'убрати', 'гайнувати', 'морити', 'втирати',
         'скартати', 'дорікнути', 'устромлюватися', 'придивитися', 'пеняти', 'углядатися', 'втуплювати', 'різати',
         'підсилитися', 'спалювати', 'сточити', 'крушити', 'шпигонути', 'муляти', 'виговорити', 'докучити',
         'закатовувати', 'розкраювати', 'укласти', 'розіпнути', 'пожити', 'приглядітися', 'вкласти', 'розтерзувати', 'тиранити',
         'затирати', 'зажити', 'упнутися', 'прохарчитися', 'промацувати', 'убирати', 'штрикнути', 'поживати',  'прокусити', "вп'ястися",
        'обгризти', 'понівечити', 'встромлятися', 'проштрикувати', 'терзати', 'пожалити', 'втерти', 'пройняти', 'втуплюватися', 'спалити',
        'прожирати', 'картати', 'кусати', 'ужалити', 'злигати', 'замучити', 'мордувати', 'встромитися', 'пекти', 'устромлятися'],
    "швидкий": ["звинний", "спірний", "ворухливий", "непосидючий", "раптовий"],
    "придбати": ['наживати', 'добутися', 'вибороти', 'зібратися', 'назбирувати', 'засягти', 'стягатися', 'завойовувати',
             'назбивати', 'осягнути', 'набирати', 'прибути', 'добуватися', 'набрати', 'стягнутися', 'скласти', 'добитися',
             'набувати', 'настаратися', 'стягати', 'скупати', 'збивати', 'відкупити', 'виборювати', 'сягати', 'доскочити',
             'нагромадити', 'засягати', 'набратися', 'взяти', 'складатися', 'здобувати', 'стягтися', 'окупати', 'осягати',
             'накопичити', 'приживати', 'назбирати', 'надбати', 'стягувати', 'зажити', 'здобути', 'перекупити', 'перекуповувати', 
             'нажити', 'стягуватися', 'набиратися', 'досягти', 'стягнути', 'збити', 'набути',  'досягнути', 'складати', 'справити',
             'заживати', 'відкуповувати', 'справляти', 'накупляти', 'осягти', 'досягати', 'настягати', 'скупляти',
             'накопичувати', 'накуповувати', 'нагромаджувати', 'завоювати', 'наскладати', 'засягнути', 'збиратися', 
             'добувати', 'скластися', 'обладнати', 'добиватися', 'окупити', 'перекупляти', 'прижити','стягти', "перекупати"],
    'встановити': ['приладнати', 'побачити', 'притулювати', 'поміщати', 'узаконювати', 'примостити',
               'визначувати',  'знаходити', 'становити', 'притуляти', 'примощувати',  'назнавати',
               'назнати', 'настановляти', 'канонізувати', 'узаконити', 'притулити', 'декретувати',
               'прилаштовувати', 'настановити', 'легалізувати', 'ладнати', 'припасувати', 'знайти', 
               'ставляти', 'припасовувати'],
    'поганий': ['скоромний', 'нечистий', 'низький', 'приперчений', 'чорт', 'незавидний', 'нецензурний',
            'базарний', 'хирний', 'нечесний',  'страмнити', 'недоброзичливий', 'противний', 'некрасивий', 'солоний',
            'цинічний', 'шкодливий', 'стидкий', 'розпусний', 'брутальний', 'нікчемний', 'пакосний', 'грубий', 
            'злобивий', 'падлючий', 'безличний', 'непутящий', 'невірний', 'недостойний', 'плюгавий', 'непристойний', 'страмний', 
            'стидний', 'нескромний', 'непорядний', 'злобний', 'соромітний', 'останній', 'собакуватий', 'нещасний', 'біс',
            'злісливий', 'огидний', 'худий', 'крутий', 'злющий', 'ниций', 'масний', 'непевний', 'недобрити', 'бридкий',
            'свинський', 'вадкий', 'неякісний', 'злючий', 'шпетний', 'злостивий', 'послідущий', 'чортячий', 'негідний', 
            'озлоблений', 'негарний', 'злосливий', 'незугарний', 'недоброякісний', 'задрипаний', 'злісний', 'безсоромний',
            'порнографічний', 'ледачий', 'паплюжний', 'сласний', 'безстидний', 'злити', 'ганебний', 'шолудивий', 'пакісний',
            'підлити', 'сороміцький', 'заїлий', 'капосний', 'жовчний', 'підлий', 'шкідливий' 'неважний', 'хтивий', 'миршавий',
            'брудний', 'лихий', 'нездоровий', 'невродливий', 'тлінний',  'лютий', 'вадливий', 'добірний', 'срамотний','отруйний', 'чорний'],
    'радувати': ['принадити', 'принаджувати', 'причарувати',  'просвітлювати', 'приковувати', 'спокусити',
             'манити', 'причаровувати', 'просвітляти', 'всолодити', 'приваблювати', 'привернути',
             'приманити', 'притягувати', 'притягти', 'просвітлити',  'привабити', 'привертати', 'усолодити', 
             'притягнути', 'красувати', 'утішити', 'ощасливлювати', 'приманювати', 'спокушати', 'прикувати'],
    "цікавий": ["поманливий"],
    "повністю": ["притьмом"],
    "красивий": ["дивний"],
    "плюс": ["зверхність"],
    "швидко": ["поривно", "поривчасто"],
    "комплект": ["куверт"],
    "колір": ["масть"],
    "річ": ['поводження', 'політика', 'політик', 'орація', 'слово', 'вантаж', 'багаж', 'поведінка',
        'поступування', 'мова', 'виступ', 'обходини', 'глагол', 'поведення', 'поступки',
        'поклажа', 'позиція', 'бесіда', 'обходження', 'діяння', 'мовлення', 'промова', 'манера',
        'язик', 'дії', 'рація', 'манери'],
    'документ': ['бомага', 'папірець', 'карта', 'папірчик', 'папір'],
    "розмах": ["привілля"],
    'вищий': ['привілейований', 'вищий', 'упривілейований', 'чистий'],
    'піт': ['випоти', 'випотина'],
    "ціна": ["утримання", "оцінка", "жалування"],
    "корисний": ["поплатний", "небезкорисний"],
    "надзвичайно": ["жахливо"],
    "дякувати": ["поблагословити"],
    "розтікатися": ["обійти"],
    "довіряти": ["покинути"],
    'екран': ['кіномистецтво', 'кіно', 'кінематографія', 'кінематограф'],
    "зайвий": ["придатковий"],
    "приємний": ["дорогий", "жаданий"],
    "протікати": ["виходити", "вийти"],
    "коробка": ["коробко"],
    "новеньке": ['свіжак', 'початківець', 'новачок', 'новак', 'новачка'],
    "прекрасний": ["дивний"],
    'молоко' : ['пасока', 'сік', 'налив', 'покорм'],
    "розмір": ["розміром"],
    "зіркий": ['світити', 'знаменитість', 'світило'],
    "зірка": ['світити', 'знаменитість', 'світило'],
    "користуватися": ["витратити", "пожити", "притягти"],
    "довжина": ['удовжки', 'вдовжки', 'завдовжки'],
    "ванна": ['купіль', 'ванний'],
    "тис": ["тиснути"],
    "погано": ["двійка"],
    "відповідати": ["відрікати"],
    "рости": ["поважчати"],
    "частий": ["квапливий"],
    'губи': ["губа", 'губити', 'гриб'],
    "сухий": ['черствий', 'помірний', 'сухотілий', 'відмерлий', 'віджилий', 'худющий', 'безкровний', 'похуділий', 'сухоребрий',
          'витриманий', 'невиразний', 'підсохлий', 'неживий', 'бездощевий', 'безживний', 'марний', 'спокійний', 'атрофований',
          'бездушний', 'похудлий', 'посушливий', 'нечутливий', 'холоднокровний', 'посушний', 'товстошкурий', 'посохлий', 'офіційний', 
          'поміркований', 'драбинчастий', 'худючий', 'буденний', 'сірий', 'стриманий', 'засушливий', 'схудлий', 'безбарвний', 'байдужий',
          'бездощівний', 'здержаний', 'виснажений', 'мертвий', 'крижаний', 'загрубілий', 'безплотний', "кам'яний", 'врівноважений',
          'просохлий', 'зимний', 'щуплий', 'сухаристий'],
    "десерт": ["солодкий"],
    "показувати": ['наябедничати'],
    'нему': ['чортма', 'чортмає', 'бігма', 'катма', 'немає', 'трясцяма'],
    "розташування": ['обернений', 'інверсійний', 'обернутий'],
    "радити": ["наказувати"],
    "погана": ['пара'],
    "двома": ['незадовільно', 'погана', 'погано', 'пара', 'двійка'],
    "набір": ['некрутчин', 'побір', 'ладунок', 'призва', 'вага', 'некрутчина', 'грузнути', 'призов',
          'рекрутчина', 'ноша', 'некрутство', 'тягар', 'багаж', 'прийом', 'куверт', 'мобілізація', 'вантажити',
          'приймання', 'вербунка', 'призвати', 'вербунок', 'навантаження', 'бранка', 'комплектування', 'рекрутство', 'вантаж'],
    'синій': ['електрик', 'синіти', 'електрика', 'лазуровий'],
    "видно": ['мабути', 'мати',  'пака', 'світло', 'слідно', 'знати', 'певний',
          'правдоподібно', 'очевидячки', 'пак', 'надісь', 'безмаль', 'могти', 
          'маяти',  'мабіть',  "мо'", 'надіятися', 'очевидно', 'ачей', 'ясно',
          'відати', 'допевний', 'проба', 'мабут','мабута'],
    "навушник": ['шептун','фіскал', 'лягавий', 'ябедник', 'виказувач', 'доносити', 'донощик',
                 'сексот', 'нашіптувач', 'ябеда', 'викажчик', 'стукач', 'вухо', 'доношувач',
                   'конфідент','доносник'],
    "гірка": ['перчиковий', 'грішна вод', 'спотикач', 'калганівка', 'пінний', 'запридух', 'гіркий',
            'зілля', 'монополька', 'сірка', 'перцівка', 'шумівка', 'цитринівка', 'шнапс', 'чикилдиха', 
            'полинний', 'перчиков', 'перчикова', 'горобиновий', 'сорокаградусний', 'тютюнковий',
            'димка', 'сивуха', 'мокруха', 'грішна водий', 'паленко', 'запіканка', 'самогон',
            'калгановий', 'тютюнков', 'самогонка', 'адамові слізка', 'горівка', 'варена', 'сірко', 'живиця',
            'зелений змій', 'вистоянка', 'зубрівка', 'первак', 'зелений змія', 'калинівка', 'очищений', 'ханжа',
            'перчаківка', 'варенуха', "слив'янка", 'трунок', 'оковитка', 'полинівка', 'вистоянко', 'горобинівка',
            'калганка', 'казенко', 'скляний бог', 'калганний', 'веселуха', 'оковита', 'калганна', 'сливовиця',
            'сабашівка', 'старка', 'спотикайло', 'запікана', 'вистоянок', 'лимонівка', 'сабашівко', 'калганн',
            'сливник', 'варений'],
    "зручний": ["придобний", "зграбний", "меткий", "звинний", "спритний", "зугарний", "прудкий", "шпаркий", "хапкий", 
                "повороткий", "проворний", "поправний"],
    "рекомендувати": ['репрезентувати', 'познайомити', 'знайомити', 'представити', 'представляти', 'познакомити', 'зазнайомлювати', 'знакомити', 'зазнайомити']}

remove_list = ["пестл", "розм", "від", "за", "жм", "як зв", "жарт", "тйж-ба"]

morph = pymorphy2.MorphAnalyzer(lang='uk')

def read_and_process_synonym_dict(path_to_dict):
    with open(path_to_dict, 'r', encoding='utf-8') as file:
        dict_ = json.load(file)
    
    dict_processed = {}
    for i in tqdm(dict_, desc="Processing synonym dict"):
        if len(i["synsets"]) == 0:
            continue

        lemma = i["lemma"].lower()

        if lemma not in dict_processed:
            dict_processed[lemma] = []
        
        for synset in i["synsets"]:
            normal_synsets = set([parced_word.normal_form for lemma in synset["clean"] for parced_word in morph.parse(lemma)])
            dict_processed[lemma].extend(normal_synsets)
        
        dict_processed[lemma] = list(set(dict_processed[lemma]) - {lemma})
    return dict_processed

def remove_synonyms(synonym_dict, deletions):
    for key, values_to_remove in deletions.items():
        if key in synonym_dict:  # Check if the key exists in synonym_dict
            for value in values_to_remove:
                if value in synonym_dict[key]:  # Check if the value exists in the list
                    synonym_dict[key].remove(value)

def add_synonyms_from_antonyms_info(synonym_dict, antonyms):
    for lemma in antonyms.keys():
        if lemma in synonym_dict:
            synonym_dict[lemma] = list(set(synonym_dict[lemma] + antonyms[lemma]['synonyms']))
        else:
            synonym_dict[lemma] = antonyms[lemma]['synonyms']
    return synonym_dict

def remove_antonyms_from_synonym_dict(synonym_dict, antonyms):
    for lemma in antonyms.keys():
        if lemma in synonym_dict:
            synonym_dict[lemma] = [item for item in synonym_dict[lemma] if item not in antonyms[lemma]['antonyms']]
    return synonym_dict

import json

def load_entries_by_lemma(path):
    """
    Load a JSON-lines file into a dict keyed by each entry's 'lemma'.
    Tries UTF-8 (with BOM) then CP1251 if decoding fails.
    """
    for enc in ('utf-8-sig', 'cp1251'):
        try:
            with open(path, 'r', encoding=enc, errors='strict') as f:
                data = {}
                for lineno, line in enumerate(f, 1):
                    line = line.strip()
                    if not line:
                        continue

                    # first try normal JSON
                    try:
                        entry = json.loads(line)
                    except json.JSONDecodeError:
                        # maybe double-escaped unicode like "\\u043d"
                        fixed = line.encode('utf-8').decode('unicode_escape')
                        entry = json.loads(fixed)

                    lemma = entry.get('lemma').lower()
                    if not lemma:
                        raise ValueError(f"Line {lineno}: missing 'lemma' field")

                    # store the whole entry (minus lemma if you want)
                    data[lemma] = {
                        'url': entry.get('url'),
                        'synonyms': entry.get('synonyms', []),
                        'antonyms': entry.get('antonyms', []),
                        'samples': entry.get('samples', []),
                    }
                    data[lemma]['antonyms'] = [i.lower() for i in data[lemma]['antonyms']]
                    data[lemma]['synonyms'] = [i.lower() for i in data[lemma]['synonyms']]
                return data

        except (UnicodeDecodeError, ValueError) as e:
            print(f"✘ Failed to load with encoding {enc!r}: {e!s}")

    raise UnicodeError(f"Could not decode {path!r} with any of utf-8-sig or cp1251")


def load_dict_from_json(path: str) -> dict:
    with open(path, 'r', encoding='utf-8') as f:
        return json.load(f)


from collections import defaultdict
from typing import Dict, List

def merge_synonym_dicts(
    d1: Dict[str, List[str]],
    d2: Dict[str, List[str]],
    dedupe: bool = True
) -> Dict[str, List[str]]:
    """
    Merge two dicts mapping word → [synonyms].
    - Keys in both get their lists concatenated.
    - Keys in only one are copied over.
    - If dedupe=True, duplicate synonyms are removed (preserving order).
    """
    merged = defaultdict(list)

    # add from first dict
    for word, syns in d1.items():
        merged[word].extend(syns)

    # add from second dict
    for word, syns in d2.items():
        merged[word].extend(syns)

    if dedupe:
        # remove duplicates while preserving order
        for word, syns in merged.items():
            seen = set()
            unique = []
            for s in syns:
                if s not in seen:
                    seen.add(s)
                    unique.append(s)
            merged[word] = unique

    return dict(merged)


def read_and_clean_synonym_dict(path_to_dict, use_antonyms=False, used_hand_parse=False):
    synonym_dict = read_and_process_synonym_dict(path_to_dict)

    if used_hand_parse:
        hand_parsed = load_dict_from_json('hand_parsed_top_100.json')
        synonym_dict = merge_synonym_dicts(synonym_dict, hand_parsed)

    if use_antonyms:
        antonyms = load_entries_by_lemma('/home/mudryi/phd_projects/synonym_attack/synonyms_dictionaries/antonimy.jsonlines')
        synonym_dict = add_synonyms_from_antonyms_info(synonym_dict, antonyms)
        synonym_dict = remove_antonyms_from_synonym_dict(synonym_dict, antonyms)

    remove_synonyms(synonym_dict, deletions)

    for key in synonym_dict:
        synonym_dict[key] = [word for word in synonym_dict[key] if word not in remove_list]
        return synonym_dict